<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BinSight - Surveillance Intelligente des Poubelles Publiques</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <style>
        #map { height: 400px; }
        .file-upload {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem;
            border: 2px dashed #ccc;
            border-radius: 0.5rem;
            transition: all 0.3s;
        }
        .file-upload:hover {
            border-color: #4ade80;
            background-color: #f0fdf4;
        }
        .file-upload.dragover {
            border-color: #4ade80;
            background-color: #f0fdf4;
        }
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 6px;
        }
        .status-empty { background-color: #4ade80; }
        .status-full { 
            background-color: #ef4444;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-green-600 text-white shadow-lg">
        <div class="container mx-auto px-4 py-6 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fas fa-trash-alt text-2xl"></i>
                <h1 class="text-2xl font-bold">BinSight</h1>
            </div>
            <nav class="hidden md:flex space-x-6">
                <a href="#" class="hover:text-green-200 font-medium">Accueil</a>
                <a href="#" class="hover:text-green-200 font-medium">Signalements</a>
                <a href="#" class="hover:text-green-200 font-medium">Statistiques</a>
                <a href="#" class="hover:text-green-200 font-medium">À propos</a>
            </nav>
            <div class="flex items-center space-x-4">
                <button class="bg-green-700 hover:bg-green-800 px-4 py-2 rounded-lg font-medium transition">
                    <i class="fas fa-user mr-2"></i>Connexion
                </button>
                <button class="md:hidden text-2xl" id="mobile-menu-button">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
        <!-- Mobile menu -->
        <div class="md:hidden hidden bg-green-700 px-4 py-2" id="mobile-menu">
            <a href="#" class="block py-2 hover:text-green-200">Accueil</a>
            <a href="#" class="block py-2 hover:text-green-200">Signalements</a>
            <a href="#" class="block py-2 hover:text-green-200">Statistiques</a>
            <a href="#" class="block py-2 hover:text-green-200">À propos</a>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="bg-gradient-to-r from-green-500 to-green-700 text-white py-16">
        <div class="container mx-auto px-4 text-center">
            <h2 class="text-4xl font-bold mb-4">Surveillance Intelligente des Poubelles Publiques</h2>
            <p class="text-xl mb-8 max-w-3xl mx-auto">
                Une solution innovante pour détecter l'état des poubelles et améliorer la gestion des déchets urbains
            </p>
            <div class="flex flex-col md:flex-row justify-center gap-4">
                <button class="bg-white text-green-700 hover:bg-gray-100 px-6 py-3 rounded-lg font-bold text-lg transition shadow-lg">
                    <i class="fas fa-upload mr-2"></i>Signaler une poubelle
                </button>
                <button class="bg-transparent border-2 border-white hover:bg-white hover:text-green-700 px-6 py-3 rounded-lg font-bold text-lg transition">
                    <i class="fas fa-map-marked-alt mr-2"></i>Voir la carte
                </button>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-12">
        <!-- Upload Section -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-center">Signaler une poubelle</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="file-upload" id="drop-area">
                    <i class="fas fa-cloud-upload-alt text-5xl text-green-500 mb-4"></i>
                    <h3 class="text-xl font-semibold mb-2">Déposez votre image ici</h3>
                    <p class="text-gray-500 mb-4">ou</p>
                    <input type="file" id="file-input" accept="image/*" class="hidden">
                    <label for="file-input" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg cursor-pointer transition">
                        <i class="fas fa-folder-open mr-2"></i>Parcourir les fichiers
                    </label>
                    <p class="text-sm text-gray-500 mt-4">Formats supportés: JPG, PNG, JPEG</p>
                </div>
                <div>
                    <h3 class="text-xl font-semibold mb-4">Ajouter des détails</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-gray-700 mb-2">Localisation</label>
                            <input type="text" placeholder="Adresse ou coordonnées GPS" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">Type de poubelle</label>
                            <select class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                                <option>Sélectionnez un type</option>
                                <option>Poubelle standard</option>
                                <option>Poubelle de tri</option>
                                <option>Conteneur</option>
                                <option>Autre</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">Commentaire (optionnel)</label>
                            <textarea rows="3" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500" placeholder="Ajoutez des détails supplémentaires..."></textarea>
                        </div>
                        <button class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition w-full">
                            <i class="fas fa-paper-plane mr-2"></i>Envoyer le signalement
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Map Section -->
        <section class="mb-16">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-3xl font-bold">Cartographie des poubelles</h2>
                <div class="flex space-x-2">
                    <button class="bg-green-600 text-white px-4 py-2 rounded-lg">
                        <i class="fas fa-filter mr-2"></i>Filtrer
                    </button>
                    <button class="bg-gray-200 hover:bg-gray-300 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-sync-alt mr-2"></i>Actualiser
                    </button>
                </div>
            </div>
            <div class="bg-white rounded-xl shadow-lg p-4">
                <div id="map" class="rounded-lg"></div>
                <div class="flex justify-center mt-4 space-x-6">
                    <div class="flex items-center">
                        <span class="status-indicator status-empty"></span>
                        <span>Vide</span>
                    </div>
                    <div class="flex items-center">
                        <span class="status-indicator status-full"></span>
                        <span>Pleine</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Stats Section -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold mb-8 text-center">Statistiques et analyses</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500">Signalements aujourd'hui</p>
                            <h3 class="text-3xl font-bold mt-2">124</h3>
                        </div>
                        <div class="bg-green-100 p-3 rounded-full">
                            <i class="fas fa-upload text-green-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <p class="text-green-600 font-medium">
                            <i class="fas fa-arrow-up mr-1"></i>12% depuis hier
                        </p>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500">Poubelles pleines</p>
                            <h3 class="text-3xl font-bold mt-2">27</h3>
                        </div>
                        <div class="bg-red-100 p-3 rounded-full">
                            <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <p class="text-red-600 font-medium">
                            <i class="fas fa-arrow-up mr-1"></i>8% depuis hier
                        </p>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500">Taux de précision</p>
                            <h3 class="text-3xl font-bold mt-2">92.5%</h3>
                        </div>
                        <div class="bg-blue-100 p-3 rounded-full">
                            <i class="fas fa-brain text-blue-600 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <p class="text-blue-600 font-medium">
                            <i class="fas fa-arrow-up mr-1"></i>3.2% ce mois-ci
                        </p>
                    </div>
                </div>
            </div>
            <div class="bg-white p-6 rounded-xl shadow-lg">
                <canvas id="statsChart" height="300"></canvas>
            </div>
        </section>

        <!-- Recent Reports -->
        <section>
            <h2 class="text-3xl font-bold mb-6">Derniers signalements</h2>
            <div class="bg-white rounded-xl shadow-lg overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Image</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Localisation</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Statut</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex-shrink-0 h-10 w-10">
                                        <img class="h-10 w-10 rounded-full object-cover" src="https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=500&q=60" alt="">
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm font-medium text-gray-900">Rue de Seine</div>
                                    <div class="text-sm text-gray-500">Paris, 75006</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="status-indicator status-full"></span>
                                    <span class="text-sm font-medium text-red-600">Pleine</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    5 min
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <a href="#" class="text-green-600 hover:text-green-900 mr-3">Voir</a>
                                    <a href="#" class="text-blue-600 hover:text-blue-900">Traiter</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex-shrink-0 h-10 w-10">
                                        <img class="h-10 w-10 rounded-full object-cover" src="https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=500&q=60" alt="">
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm font-medium text-gray-900">Rue de Vaugirard</div>
                                    <div class="text-sm text-gray-500">Paris, 75006</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="status-indicator status-full"></span>
                                    <span class="text-sm font-medium text-red-600">Pleine</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    8 min
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <a href="#" class="text-green-600 hover:text-green-900 mr-3">Voir</a>
                                    <a href="#" class="text-blue-600 hover:text-blue-900">Traiter</a>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex-shrink-0 h-10 w-10">
                                        <img class="h-10 w-10 rounded-full object-cover" src="https://images.unsplash.com/photo-1493809842364-78817add7ffb?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=500&q=60" alt="">
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm font-medium text-gray-900">Rue de Rennes</div>
                                    <div class="text-sm text-gray-500">Paris, 75006</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="status-indicator status-full"></span>
                                    <span class="text-sm font-medium text-red-600">Pleine</span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    12 min
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <a href="#" class="text-green-600 hover:text-green-900 mr-3">Voir</a>
                                    <a href="#" class="text-blue-600 hover:text-blue-900">Traiter</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="bg-gray-50 px-6 py-3 flex items-center justify-between border-t border-gray-200">
                    <div class="flex-1 flex justify-between sm:hidden">
                        <a href="#" class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                            Précédent
                        </a>
                        <a href="#" class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                            Suivant
                        </a>
                    </div>
                    <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
                        <div>
                            <p class="text-sm text-gray-700">
                                Affichage de <span class="font-medium">1</span> à <span class="font-medium">3</span> sur <span class="font-medium">24</span> résultats
                            </p>
                        </div>
                        <div>
                            <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px" aria-label="Pagination">
                                <a href="#" class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                                    <span class="sr-only">Précédent</span>
                                    <i class="fas fa-chevron-left"></i>
                                </a>
                                <a href="#" aria-current="page" class="z-10 bg-green-50 border-green-500 text-green-600 relative inline-flex items-center px-4 py-2 border text-sm font-medium">
                                    1
                                </a>
                                <a href="#" class="bg-white border-gray-300 text-gray-500 hover:bg-gray-50 relative inline-flex items-center px-4 py-2 border text-sm font-medium">
                                    2
                                </a>
                                <a href="#" class="bg-white border-gray-300 text-gray-500 hover:bg-gray-50 relative inline-flex items-center px-4 py-2 border text-sm font-medium">
                                    3
                                </a>
                                <a href="#" class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                                    <span class="sr-only">Suivant</span>
                                    <i class="fas fa-chevron-right"></i>
                                </a>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i class="fas fa-trash-alt mr-2"></i> BinSight
                    </h3>
                    <p class="text-gray-400">
                        Une solution innovante pour améliorer la gestion des déchets urbains grâce à l'intelligence artificielle.
                    </p>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Liens rapides</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Accueil</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Signalements</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Statistiques</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">À propos</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Ressources</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Documentation</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">API</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">FAQ</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-lg font-semibold mb-4">Newsletter</h4>
                    <p class="text-gray-400 mb-4">
                        Abonnez-vous pour recevoir les dernières actualités et mises à jour.
                    </p>
                    <div class="flex">
                        <input type="email" placeholder="Votre email" class="px-4 py-2 rounded-l-lg w-full focus:outline-none text-gray-800">
                        <button class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-r-lg transition">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-8 flex flex-col md:flex-row justify-between items-center">
                <p class="text-gray-400 mb-4 md:mb-0">
                    © 2023 BinSight. Tous droits réservés.
                </p>
                <div class="flex space-x-6">
                    <a href="#" class="text-gray-400 hover:text-white transition">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        let poubelles = []; // rendue globale
        // Mobile menu toggle
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        });

        // File upload drag and drop
        const dropArea = document.getElementById('drop-area');
        const fileInput = document.getElementById('file-input');

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            dropArea.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropArea.addEventListener(eventName, unhighlight, false);
        });

        function highlight() {
            dropArea.classList.add('dragover');
        }

        function unhighlight() {
            dropArea.classList.remove('dragover');
        }

        dropArea.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            handleFiles(files);
        }

        fileInput.addEventListener('change', function() {
            handleFiles(this.files);
        });

        function handleFiles(files) {
            if (files.length) {
                const file = files[0];
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        // Here you would typically send the image to your backend for processing
                        alert('Image chargée avec succès! Traitement en cours...');
                        // Simulate processing
                        setTimeout(() => {
                            alert('Analyse terminée: Poubelle pleine détectée (92% de confiance)');
                        }, 2000);
                    };
                    reader.readAsDataURL(file);
                } else {
                    alert('Veuillez sélectionner une image valide.');
                }
            }
        }

        function initMap() {
        const map = L.map('map').setView([48.8566, 2.3522], 13);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        const greenIcon = L.divIcon({
            html: '<span class="status-indicator status-empty"></span>',
            className: '',
            iconSize: [12, 12]
        });

        const redIcon = L.divIcon({
            html: '<span class="status-indicator status-full"></span>',
            className: '',
            iconSize: [12, 12]
        });

        // Données partagées
        poubelles = [
            { lat: 48.8566, lng: 2.3522, status: 'pleine', time: '10 min', location: 'Place de la Mairie' },
            { lat: 48.8575, lng: 2.3585, status: 'pleine', time: '25 min', location: 'Rue de Rivoli' },
            { lat: 48.8550, lng: 2.3465, status: 'vide', time: '1 heure', location: 'Boulevard Saint-Germain' },
            { lat: 48.8585, lng: 2.3376, status: 'pleine', time: '5 min', location: 'Rue de Seine' },
            { lat: 48.8595, lng: 2.3476, status: 'pleine', time: '15 min', location: 'Rue des Saints-Pères' },
            { lat: 48.8545, lng: 2.3376, status: 'vide', time: '45 min', location: 'Rue de Buci' },
            { lat: 48.8535, lng: 2.3476, status: 'pleine', time: '20 min', location: 'Rue de l\'Ancienne Comédie' },
            { lat: 48.8525, lng: 2.3576, status: 'vide', time: '2 heures', location: 'Rue de Tournon' },
            { lat: 48.8515, lng: 2.3676, status: 'pleine', time: '8 min', location: 'Rue de Vaugirard' },
            { lat: 48.8505, lng: 2.3776, status: 'pleine', time: '12 min', location: 'Rue de Rennes' }
        ];

        poubelles.forEach(poubelle => {
            const icon = poubelle.status === 'pleine' ? redIcon : greenIcon;
            const marker = L.marker([poubelle.lat, poubelle.lng], { icon }).addTo(map);

            const popupContent = `
                <div class="p-2">
                    <h3 class="font-bold mb-2">${poubelle.location}</h3>
                    <p class="mb-1">Statut: <span class="font-medium ${poubelle.status === 'pleine' ? 'text-red-600' : 'text-green-600'}">${poubelle.status}</span></p>
                    <p class="mb-1">Signalé il y a: ${poubelle.time}</p>
                    <div class="mt-2">
                        <button class="bg-green-600 text-white px-2 py-1 rounded text-sm hover:bg-green-700 transition" onclick="handleAction('view', '${poubelle.location}')">
                            <i class="fas fa-eye mr-1"></i>Voir
                        </button>
                        <button class="bg-blue-600 text-white px-2 py-1 rounded text-sm hover:bg-blue-700 transition ml-2" onclick="handleAction('process', '${poubelle.location}')">
                            <i class="fas fa-check mr-1"></i>Traiter
                        </button>
                    </div>
                </div>
            `;
            marker.bindPopup(popupContent);
        });

        const bounds = poubelles.map(p => [p.lat, p.lng]);
        map.fitBounds(bounds, { padding: [50, 50] });
    }

    function handleAction(action, location) {
        if (action === 'view') {
            alert(`Affichage des détails pour la poubelle à ${location}`);
        } else if (action === 'process') {
            alert(`Traitement de la poubelle à ${location}`);
        }
    }

    function generateRecentReports() {
        const tbody = document.querySelector("section table tbody");
        tbody.innerHTML = "";

        poubelles.forEach((poubelle, index) => {
            const row = document.createElement("tr");

            row.innerHTML = `
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="flex-shrink-0 h-10 w-10">
                        <img class="h-10 w-10 rounded-full object-cover" src="https://source.unsplash.com/50x50/?trash,bin&sig=${index}" alt="">
                    </div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <div class="text-sm font-medium text-gray-900">${poubelle.location}</div>
                    <div class="text-sm text-gray-500">Paris, 75006</div>
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                    <span class="status-indicator ${poubelle.status === 'pleine' ? 'status-full' : 'status-empty'}"></span>
                    <span class="text-sm font-medium ${poubelle.status === 'pleine' ? 'text-red-600' : 'text-green-600'}">${poubelle.status.charAt(0).toUpperCase() + poubelle.status.slice(1)}</span>
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${poubelle.time}</td>
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <button onclick="handleAction('view', '${poubelle.location}')" class="text-green-600 hover:text-green-900 mr-3">Voir</button>
                    <button onclick="handleAction('process', '${poubelle.location}')" class="text-blue-600 hover:text-blue-900">Traiter</button>
                </td>
            `;
            tbody.appendChild(row);
        });
    }

    function initChart() {
        const ctx = document.getElementById('statsChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Fév', 'Mar', 'Avr', 'Mai', 'Juin', 'Juil', 'Août', 'Sep', 'Oct', 'Nov', 'Déc'],
                datasets: [
                    {
                        label: 'Poubelles vides',
                        data: [120, 135, 150, 165, 180, 195, 210, 225, 210, 195, 180, 165],
                        borderColor: '#4ade80',
                        backgroundColor: 'rgba(74, 222, 128, 0.1)',
                        tension: 0.3,
                        fill: true
                    },
                    {
                        label: 'Poubelles pleines',
                        data: [80, 85, 90, 95, 100, 105, 110, 115, 120, 125, 130, 135],
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.3,
                        fill: true
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Évolution des signalements par mois',
                        font: {
                            size: 16
                        }
                    },
                    legend: {
                        position: 'top',
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Nombre de signalements'
                        }
                    }
                }
            }
        });
    }

    document.addEventListener('DOMContentLoaded', () => {
        initMap();
        initChart();
        setTimeout(generateRecentReports, 200); // attendre les données de la carte
    });
</script>
</body>
</html>